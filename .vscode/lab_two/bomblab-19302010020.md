# ICS-Lab2说明文档

19302010020袁逸聪 

## phase_1

运行后来到phase_1，disas看到

将立即数0x4023b0传入%esi后，调用了strings_not_equal，并test返回值

返回1则引爆炸弹，0则结束函数

猜测是将输入与预存的string相对比，相同通过、不同引爆

x/s 0x4023b0查看，得到预存字符串"Houses will begat jobs, jobs will begat houses."

disas strings_not_equal看到

1. 输入字符串与预存字符串的地址分别被移到%rbx、%rbp
2. 先后调用string_length并比较结果，长度不同则返回1
3. 逐字符比较了两个字符串，发现不同字符则返回1
4. 长度相同、都相同，可以返回0

故，phase_1的密码就是与预存字符串相同的输入

## phase_2

disas phase_2看到它调用了read_six_numbers，可知输入为6个数字

接下来比较0x0与(%rsp),能看到%rsp中储存的正是首个输入数所在地址，其余输入紧随其后

比较限制了输入数需要>0，否则引爆炸弹

在<+71>处，看到%ebx与6比较，不等将跳转，等则结束函数。而对ebx既有的操作是初始化赋值1与<+64>处的+1，可知将有5次循环，从1到5

可以推断，这是循环控制器，phase_2将对6个输入数进行操作：

1. 从<+49>到<+54>为关键部分
2. 将%eax中值写为当前轮次+当前考察的输入数
3. 将%eax储存的计算结果与下一个输入数比较，不相等引爆、相等通过
4. 第i个输入数与第i+1个输入数的差需要为i

故，phase_2的密码为首项不为0的6项数列，且a(i+1)=ai+1，如1 2 4 7 11 16

## phase_3

disas phase_3看到在扫描输入前，为%esi赋值了0x4025af

x/s查看其储存内容为"%d %d"，可知输入为2个数字，以下简称为A、B

输入数储存在%rsp所指处，函数先将A与7比较，大于7则引爆。故输入A应小于等于7

<+57>跳转到0x402420+A*8处，print *0x402420@20能够发现，数组中储存的是phase_3代码段地址

故此处应为对A的switch判断

反复出现到<+130>的跳转，可以推测为break之后的代码

<+130>处比较了%eax与B，相等则通过，B是第二个输入数，返回去看%eax如何决定

发现在各个switch分支中，为%eax赋予了不同的数值

A取1~7时对应B输入为：294 813 627 250 340 106 81，任取一组即可

## phase_4

